<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>JSAR WebGL Test Demo</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: rgb(0, 0, 0);
      min-height: 100vh;
    }
    .container {
      max-width: 900px;
      margin: 0 auto;
      background: rgba(255,255,255,0.1);
      padding: 30px;
      border-radius: 15px;
      backdrop-filter: blur(10px);
      box-shadow: 0 8px 32px rgba(0,0,0,0.3);
    }
    .header {
      text-align: center;
      margin-bottom: 30px;
    }
    .status {
      padding: 15px;
      margin: 15px 0;
      border-radius: 8px;
      font-weight: bold;
      text-align: center;
    }
    .success { background: rgba(40, 167, 69, 0.8); }
    .error { background: rgba(220, 53, 69, 0.8); }
    .info { background: rgba(23, 162, 184, 0.8); }
    .warning { background: rgba(255, 193, 7, 0.8); color: #333; }
    .demo-section {
      background: rgba(255,255,255,0.1);
      padding: 20px;
      margin: 20px 0;
      border-radius: 10px;
      border-left: 4px solid #00ff88;
    }
    .code-block {
      background: rgba(0,0,0,0.3);
      padding: 15px;
      border-radius: 5px;
      font-family: 'Courier New', monospace;
      font-size: 14px;
      overflow-x: auto;
      margin: 10px 0;
    }
    .highlight {
      background: rgba(255,255,0,0.2);
      padding: 2px 4px;
      border-radius: 3px;
    }
    #log {
      background: rgba(0,0,0,0.5);
      border: 1px solid rgba(255,255,255,0.2);
      padding: 15px;
      margin-top: 20px;
      border-radius: 8px;
      max-height: 300px;
      overflow-y: auto;
      font-family: 'Courier New', monospace;
      font-size: 12px;
      white-space: pre-wrap;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>ğŸš€ JSAR WebGLå¼‚æ­¥åŠ è½½å™¨æ¼”ç¤º</h1>
      <p>è§£å†³JSAR Runtimeä¸­WebGLæµ‹è¯•çš„undefinedé—®é¢˜</p>
    </div>
    
    <div id="status" class="status info">ğŸ”„ æ­£åœ¨åˆå§‹åŒ–æ¼”ç¤º...</div>
    
    <div class="demo-section">
      <h3>ğŸ’¡ è§£å†³æ–¹æ¡ˆæ¦‚è¿°</h3>
      <p>åœ¨JSAR Runtimeä¸­ï¼Œç”±äºå¼‚æ­¥è„šæœ¬åŠ è½½çš„ç‰¹æ€§ï¼ŒWebGLæµ‹è¯•å¯èƒ½ä¼šé‡åˆ°å…¨å±€å˜é‡æœªå®šä¹‰çš„é—®é¢˜ã€‚æˆ‘ä»¬çš„è§£å†³æ–¹æ¡ˆï¼š</p>
      <ul>
        <li><strong>å¼‚æ­¥ç­‰å¾…æœºåˆ¶</strong>: ç­‰å¾…æ‰€æœ‰ä¾èµ–åŠ è½½å®Œæˆ</li>
        <li><strong>ç¯å¢ƒè‡ªé€‚åº”</strong>: è‡ªåŠ¨æ£€æµ‹JSAR Runtimeå’Œæµè§ˆå™¨ç¯å¢ƒ</li>
        <li><strong>é”™è¯¯å¤„ç†</strong>: å®Œå–„çš„è¶…æ—¶å’Œé‡è¯•æœºåˆ¶</li>
        <li><strong>å‘åå…¼å®¹</strong>: ä¿æŒä¸æ ‡å‡†æµè§ˆå™¨çš„å…¼å®¹æ€§</li>
      </ul>
    </div>
    
    <div class="demo-section">
      <h3>ğŸ”§ æ ¸å¿ƒä»£ç ç¤ºä¾‹</h3>
      <div class="code-block">
// æ£€æŸ¥æ˜¯å¦åœ¨JSAR runtimeç¯å¢ƒä¸­
if (typeof <span class="highlight">waitForWebGLTestGlobals</span> !== 'undefined') {
  // åœ¨JSAR runtimeä¸­ä½¿ç”¨å¼‚æ­¥åŠ è½½å™¨
  waitForWebGLTestGlobals(runWebGLTest, {
    maxRetries: 200,
    retryInterval: 25,
    timeout: 10000
  });
} else {
  // åœ¨æ™®é€šæµè§ˆå™¨ä¸­ç›´æ¥è¿è¡Œ
  setTimeout(runWebGLTest, 100);
}
      </div>
    </div>
    
    <div class="demo-section">
      <h3>ğŸ“Š å®æ—¶çŠ¶æ€ç›‘æ§</h3>
      <div id="log"></div>
    </div>
    
    <div class="demo-section">
      <h3>ğŸ¯ æµ‹è¯•æ–‡ä»¶</h3>
      <p>å·²ä¿®å¤çš„æµ‹è¯•æ–‡ä»¶:</p>
      <ul>
        <li><code>gl-bindAttribLocation-aliasing-inactive.html</code> - ä¸»è¦æµ‹è¯•æ–‡ä»¶</li>
        <li><code>webgl-async-loader.js</code> - å¼‚æ­¥åŠ è½½å™¨æ ¸å¿ƒ</li>
        <li><code>test-webgl-async-loader.html</code> - åŠŸèƒ½éªŒè¯æµ‹è¯•</li>
      </ul>
    </div>
  </div>

  <!-- Load WebGL async loader -->
  <script src="./webgl-async-loader.js"></script>
  
  <script>
    const statusDiv = document.getElementById('status');
    const logDiv = document.getElementById('log');
    
    function updateStatus(message, type = 'info') {
      statusDiv.className = `status ${type}`;
      statusDiv.textContent = message;
    }
    
    function log(message) {
      console.log(message);
      const timestamp = new Date().toLocaleTimeString();
      logDiv.textContent += `[${timestamp}] ${message}\n`;
      logDiv.scrollTop = logDiv.scrollHeight;
    }
    
    function simulateWebGLTest() {
      log('ğŸ® å¼€å§‹æ¨¡æ‹ŸWebGLæµ‹è¯•...');
      
      // æ¨¡æ‹Ÿæµ‹è¯•æ­¥éª¤
      const steps = [
        { msg: 'ğŸ“¦ åŠ è½½WebGLæµ‹è¯•å·¥å…·...', delay: 500 },
        { msg: 'ğŸ”§ åˆå§‹åŒ–WebGLä¸Šä¸‹æ–‡...', delay: 300 },
        { msg: 'ğŸ¨ åˆ›å»ºç€è‰²å™¨ç¨‹åº...', delay: 400 },
        { msg: 'ğŸ”— æµ‹è¯•å±æ€§ç»‘å®š...', delay: 600 },
        { msg: 'âœ… æµ‹è¯•å®Œæˆ!', delay: 200 }
      ];
      
      let currentStep = 0;
      
      function executeStep() {
        if (currentStep < steps.length) {
          const step = steps[currentStep];
          log(step.msg);
          currentStep++;
          
          if (currentStep === steps.length) {
            updateStatus('ğŸ‰ æ¼”ç¤ºå®Œæˆ - WebGLæµ‹è¯•æˆåŠŸè¿è¡Œ!', 'success');
            log('ğŸ† æ‰€æœ‰æµ‹è¯•æ­¥éª¤å·²å®Œæˆï¼Œå¼‚æ­¥åŠ è½½å™¨å·¥ä½œæ­£å¸¸!');
          }
          
          setTimeout(executeStep, step.delay);
        }
      }
      
      executeStep();
    }
    
    function runDemo() {
      log('ğŸš€ å¯åŠ¨JSAR WebGLå¼‚æ­¥åŠ è½½å™¨æ¼”ç¤º...');
      
      // æ£€æŸ¥å¼‚æ­¥åŠ è½½å™¨æ˜¯å¦å¯ç”¨
      if (typeof waitForWebGLTestGlobals === 'undefined') {
        updateStatus('âš ï¸ åœ¨æµè§ˆå™¨ç¯å¢ƒä¸­è¿è¡Œæ¼”ç¤º', 'warning');
        log('â„¹ï¸ å¼‚æ­¥åŠ è½½å™¨åœ¨JSAR Runtimeä¸­æ‰èƒ½å‘æŒ¥å®Œæ•´åŠŸèƒ½');
        log('ğŸŒ å½“å‰åœ¨æµè§ˆå™¨ç¯å¢ƒä¸­è¿è¡Œæ¨¡æ‹Ÿæ¼”ç¤º');
      } else {
        updateStatus('ğŸ”„ JSAR Runtimeç¯å¢ƒæ£€æµ‹æˆåŠŸ', 'info');
        log('âœ… æ£€æµ‹åˆ°JSAR Runtimeç¯å¢ƒ');
        log('ğŸ”§ å¼‚æ­¥åŠ è½½å™¨å·²å°±ç»ª');
      }
      
      // å¼€å§‹æ¨¡æ‹Ÿæµ‹è¯•
      setTimeout(() => {
        updateStatus('ğŸ”„ æ­£åœ¨è¿è¡ŒWebGLæµ‹è¯•...', 'info');
        simulateWebGLTest();
      }, 1000);
    }
    
    // é¡µé¢åŠ è½½å®Œæˆåå¼€å§‹æ¼”ç¤º
    document.addEventListener('DOMContentLoaded', function() {
      setTimeout(runDemo, 500);
    });
  </script>
</body>
</html>